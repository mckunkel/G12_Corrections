\documentclass[11pt,a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{authblk}
\usepackage[english]{babel}
\usepackage{fancyhdr}
\usepackage{subfig}
\usepackage{floatrow}
\usepackage{float}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{slashed}
\usepackage{graphicx}
\usepackage{todonotes}
\usepackage[toc,page]{appendix}
\usepackage{hyperref}
\usepackage{placeins}
\usepackage{cleveref}
\usepackage{multirow}
\usepackage{longtable}
\usepackage[final]{pdfpages}
\usepackage[export]{adjustbox}
\usepackage[final]{pdfpages}
\author{Michael C. Kunkel}
\title{G12 Track Normalization Procedure}
\hypersetup{
	colorlinks,
	citecolor=purple,
	filecolor=black,
	linkcolor=blue,
	urlcolor=black
}
\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
	language=Java,
	aboveskip=3mm,
	belowskip=3mm,
	showstringspaces=false,
	columns=flexible,
	basicstyle={\small\ttfamily},
	numbers=none,
	numberstyle=\tiny\color{gray},
	keywordstyle=\color{blue},
	commentstyle=\color{dkgreen},
	stringstyle=\color{mauve},
	breaklines=true,
	breakatwhitespace=true,
	tabsize=3
}
\newcommand{\abbr}[1]{\textsc{\texttt{#1}}}

\def\piz{\pi^{0}}
\def\pizT{$\pi^{0} \ $}
\def\pizDal{$\pi^{0} \rightarrow e^+e^- \gamma  $}

\def\etaT{$\eta $}
\def\etaDal{$\eta \rightarrow e^+e^- \gamma  $}

\def\omT{$\omega  $}
\def\omDal{$\omega \rightarrow e^+e^- \piz $}

\def\etaP{\eta^{\prime}}
\def\etaTP{$\eta^{\prime}  $}
\def\etaPDal{$\eta^{\prime} \rightarrow e^+e^- \gamma  $}

\def\phiT{$\phi  $}
\def\phiDal{$\phi \rightarrow e^+e^- \eta  $}
\def\phiDalT{\phi \rightarrow e^+e^- \eta  }

\def\epemT{$ e^+e^-  $}
\def\epem{e^+e^-}
\def\pipiT{$\pi^+\pi^-$}
\def\pipi{\pi^+\pi^-}


\def\phiPR{$ep\to e'p \phi \rightarrow p e^+e^- \eta$}
\def\etaPR{$ep\to e'p \etaP \rightarrow p e^+e^- \gamma$}

\def\figures{/Users/michaelkunkel/WORK/GIT_HUB/THESIS/figures/print}
\def\tables{/Users/michaelkunkel/WORK/GIT_HUB/Pi0_Papers/ANALYSIS_NOTE/tables}
\def\PI0{/Users/michaelkunkel/WORK/GIT_HUB/Pi0_Papers/ANALYSIS_NOTE/PI0.bib}
\newlength{\figwidth}
\setlength{\figwidth}{0.9\columnwidth}

\newlength{\qfigheight}
\setlength{\qfigheight}{0.25\textheight}

\newlength{\hfigheight}
\setlength{\hfigheight}{0.5\textheight}
\begin{document}
\maketitle
\section{Normalization}\label{sec:results.normalization}
\subsection{Normalization History}
In the g11 experiment there is an 18\% discrepancy between the differential cross-sections of $\gamma p \rightarrow p \omega$ measured channels $\gamma p \rightarrow p \pi^+ \pi^- (\pi^0)$ and $\gamma p \rightarrow p \pi^+ (\pi^- \pi^0)$. One method of correction for this effect was to apply a global scale factor to the two track topology. The scale factor was on the order of 18\%. The cause of the inefficiency was unknown but is believed to be due to the high current of the electron beam in conjunction with requiring 3 charged tracks from a 2-prong trigger.
\subsection{g12 Normalization Procedure}\label{sec:results.g12normalization}
In this analysis, a normalization constant on the order of 18\% was also needed. The cause of this effect is unknown, but it is also believed to be related to using 3 charged tracks from 2-prong triggers at high current. \abbr{GPP} is responsible for smearing and dropping inefficient parts of the detector but not trigger efficiency. Therefore the normalization could be simulated if it was a trigger effect or another happenstance related to requiring 3 charged tracks in the analysis. To investigate this effect the following 3 topologies;
\begin{align}\label{eq:eff_topologies}
  \gamma p \rightarrow p \pi^+ (\pi^-) \nonumber  \\
  \gamma p \rightarrow p \pi^- (\pi^+)  \nonumber \\
  \gamma p \rightarrow \pi^+ \pi^- (p)
\end{align}
were skimmed from data and simulated using the prescription chain in the approved G12 analysis procedures~\cite{g12note}. In order to eliminate any statistical effects, $\frac{1}{4}$ of the entire g12 data set was used and over 1 billion events were generated for simulation. Table~\ref{tab:eff_events} lists the number of events analyzed for each of the topologies listed in Eq.~\ref{eq:eff_topologies}.
\input{\tables/eff_stats.tex}
The data had two orders of magnitude higher statistics than the simulation, this was done to ensure enough events to analyze in the high momentum spectrum. The simulation generated the listed reactions in phase space using PLUTO++ as the phase space generator . The data and simulation were analyzed in the same manner.

The data was skimmed under the conditions of Eq.~\ref{eq:eff_topologies}. If the missing particle (particle in parenthesis) was detected, then this information was also recorded. After the data was skimmed, kinematic fits (1-C) were performed to the missing particles. Nominal geometric fiducial cuts were employed for all detected particles along with a pull probability for each topology  $>1~\%$, see Fig.~\ref{fig:eff_pull}.
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/All_Pull_Eff_Plot.pdf}
    \caption[Number of events vs. the pull distribution for the reactions used in the normalization study for data]{\label{fig:eff_pull}Number of events vs. the 1-C pull probability distribution for the reactions used in the normalization study for data.}
  \end{center}\end{figure}
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/All_Pull_Eff_PlotMC.pdf}
    \caption[Number of events vs. the pull distribution for the reactions used in the normalization study for \abbr{MC}]{\label{fig:eff_pullMC} Number of events vs. the 1-C pull probability distribution for the reactions used in the normalization study for \abbr{MC}.}
  \end{center}\end{figure}


The z-vertex of the two needed particles was determined by the method of distance of closest approach of the two vectors. The data was then binned for the fitted missing particle according to the z-vertex position, momentum, $\theta \sin\phi$, and $\theta \cos\phi$. The z-vertex and momentum binning used can be seen in Table~\ref{tab:eff_binning}. If the particle to be fit was detected by \abbr{CLAS}, the information was also binned according $z$-vertex, momentum, $\theta \sin\phi$, and $\theta \cos\phi$. However to ensure that the detected particle and the fitted missing particle were the same, the detected particle must have been in the same momentum bin as the fitted missing particle.
\input{\tables/eff_binning.tex}
The $\theta \sin\phi$ and $\theta \cos\phi$ binning was chosen to interpret the geometric x and y space the particle travels, independent of momentum and x and y vertex. These $\theta \sin\phi$ and $\theta \cos\phi$ quantities are plotted as x and y variable of a histogram. To better illustrate this interpretation consider a spherical coordinate system where;
\begin{align}
  r=\sqrt{x^2 + y^2 + z^2} \\
  x = r\sin\theta\cos\phi  \\
  y = r\sin\theta\sin\phi
\end{align}
therefore,
\begin{align}
  \theta \sin\phi = \left(\frac{\theta}{r\sin\theta}\right)y \label{eq:sin1}     \\
  \theta \cos\phi = \left(\frac{\theta}{r\sin\theta}\right)x \label{eq:sin2} \ .
\end{align}
It can be seen that plotting Eq~\ref{eq:sin2} versus Eq~\ref{eq:sin1} projects $x-y$ space.

For each type of missing particle, we plotted the number of events versus $\theta \sin\phi$ and $\theta \cos\phi$. We then plotted the number of events where the ``missing" particle was detected. The ratio of the number of detected ``missing" particle to the total number of ``missing" particles is the detection efficiency for that bin in $z$-vertex, p, $\theta \sin\phi$ and $\theta \cos\phi$ (see Figs~\ref{fig:eff_prot_data},~\ref{fig:eff_pip_data} and~\ref{fig:eff_pim_data}). This process was repeated for simulated data (see Figs~\ref{fig:eff_prot_MC},~\ref{fig:eff_pip_MC} and~\ref{fig:eff_pim_MC}). The ratio of the simulated efficiency to the measured efficiency for each particle was used to correct the data (see Figs~\ref{fig:toteff_prot},~\ref{fig:toteff_pip} and~\ref{fig:toteff_pim}). This procedure revealed any differences between the real and simulated detector responses.
\FloatBarrier
\subsection{g12 Normalization Results}

It was noticed that the simulation was over-efficient as compared to the data and the ratio of the efficiency of reconstruction should suffice as a correction to the data. Figures~\ref{fig:eff_prot_data},~\ref{fig:eff_pip_data},~\ref{fig:eff_pim_data} depict the efficiency of data reconstruction for the proton $\pi^+$ and $\pi^-$ respectively. Figures~\ref{fig:eff_prot_MC},~\ref{fig:eff_pip_MC},~\ref{fig:eff_pim_MC} depict the efficiency of the simulation reconstruction for the proton $\pi^+$ and $\pi^-$ respectively. Figures~\ref{fig:toteff_prot},~\ref{fig:toteff_pip},~\ref{fig:toteff_pim} depict the over-efficiency of the simulation to data reconstruction for the proton $\pi^+$ and $\pi^-$ respectively.
The total over-efficiency was calculated as the product of each track's over-efficiency, i.e.,
\begin{align}\label{eq:eff_tot}
  \epsilon = \epsilon_{proton}\cdot\epsilon_{\pi^+}\cdot\epsilon_{\pi^-}.
\end{align}

% % %PROT
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Prot_Thesis_EffData_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of detecting the proton with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} detection for g12]{\label{fig:eff_prot_data} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of detecting the proton with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} detection for g12.}
  \end{center}\end{figure}
%
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Prot_Thesis_EffMC_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of reconstructing the proton with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} Monte-Carlo for g12]{\label{fig:eff_prot_MC} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of reconstructing the proton with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} Monte-Carlo for g12.}
  \end{center}\end{figure}
%
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Prot_Thesis_TotEff_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the over-efficiency of simulating the proton with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction]{\label{fig:toteff_prot} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the over-efficiency of simulating the proton with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction.}
  \end{center}\end{figure}
% % %PIP
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Pip_Thesis_EffData_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of detecting the $\pi^+$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} detection for g12]{\label{fig:eff_pip_data} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of detecting the $\pi^+$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} detection for g12.}
  \end{center}\end{figure}
%
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Pip_Thesis_EffMC_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of reconstructing the $\pi^+$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} Monte-Carlo for g12]{\label{fig:eff_pip_MC} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of reconstructing the $\pi^+$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} Monte-Carlo for g12.}
  \end{center}\end{figure}
%
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Pip_Thesis_TotEff_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the over-efficiency of simulating the $\pi^+$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction]{\label{fig:toteff_pip} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the over-efficiency of simulating the $\pi^+$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction.}
  \end{center}\end{figure}
% % %PIM
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Pim_Thesis_EffData_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of detecting the $\pi^-$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} detection for g12]{\label{fig:eff_pim_data} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of detecting the $\pi^-$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} detection for g12.}
  \end{center}\end{figure}
%
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Pim_Thesis_EffMC_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of reconstructing the $\pi^-$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} Monte-Carlo for g12]{\label{fig:eff_pim_MC} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the efficiency of reconstructing the $\pi^-$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction using \abbr{CLAS} Monte-Carlo for g12.}
  \end{center}\end{figure}
%
\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/Pim_Thesis_TotEff_Plot.pdf}
    \caption[$\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the over-efficiency of simulating the $\pi^-$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction]{\label{fig:toteff_pim} $\theta \cos\phi$ vs. $\theta \sin\phi$ plot showing the over-efficiency of simulating the $\pi^-$ with z-vertex $-90\textless z\textless-85$~cm and momentum $0.75\textless p \textless 1$~GeV from a 2 charged track reaction.}
  \end{center}\end{figure}
\FloatBarrier
%
\subsection{Normalization Comparison}
To validate the g12 normalization results, the g12 $\pi^0$ differential cross-section was calculated using the G11 global normalization factor and then compared to the g12 $\pi^0$ differential cross-section using the g12 normalization procedure results. It is shown in Fig.~\ref{fig:toteff_compareI} and Fig.~\ref{fig:toteff_compareII} that the 2 methods agree with one another except for the very forward regions of $\cos\theta^{\pi^0}_{C.M.}$, where the cross-section using the dynamic normalization is larger than the cross-section measured with the G11 global normalization, however the larger cross-sections at forward $\cos\theta^{\pi^0}_{C.M.}$ agree very well with the past results, see G12 publication ~\cite{Kunkel} for the comparison.

\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/G12_XSection_Normaization_Compare_thesisI.pdf}
    \caption[$\frac{d \sigma}{d \Omega}$ vs. $\cos \theta$ plot showing the g12 \pizT differential cross-section when the G11 global normalization is used (blue) and when the g12 dynamic normalization is used (red) for various bins of beam energy inside lepton trigger acceptance]{\label{fig:toteff_compareI} $\frac{d \sigma}{d \Omega}$ vs. $\cos \theta$ plot showing the g12 \pizT differential cross-section when the G11 global normalization is used (blue) and when the g12 dynamic normalization is used (red) for various bins of beam energy inside the lepton trigger acceptance.}
  \end{center}\end{figure}

\begin{figure}[h!]\begin{center}
    \includegraphics[width=1.1 \figwidth,height=\hfigheight]{\figures/analysis/EFFICIENCY/G12_XSection_Normaization_Compare_thesisII.pdf}
    \caption[$\frac{d \sigma}{d \Omega}$ vs. $\cos \theta$ plot showing the g12 \pizT differential cross-section when the G11 global normalization is used (blue) and when the g12 dynamic normalization is used (red) for various bins of beam energy above \abbr{MORB} threshold]{\label{fig:toteff_compareII} $\frac{d \sigma}{d \Omega}$ vs. $\cos \theta$ plot showing the g12 \pizT differential cross-section when the G11 global normalization is used (blue) and when the g12 dynamic normalization is used (red) for various bins of beam energy above the \abbr{MORB} threshold.}
  \end{center}\end{figure}

\FloatBarrier

\subsection{Normalization Uncertainties}
The statistical uncertainties of the normalization correction was minimized by ensuring that the statistical sample of the data and \abbr{MC} was sufficient in each bin of $z$-vertex, momentum, $\theta \sin\phi$ and $\theta \cos\phi$. The maximum statistical uncertainty was 0.01\%. The systematic uncertainties of the normalization correction was calculated and shown in Sec.~\ref{sec:trkeffuncert}.
\input{/Users/michaelkunkel/WORK/GIT_HUB/Pi0_Papers/ANALYSIS_NOTE/RESULTS/systematic_trackEfficiency.tex}
\section{Code Templates}
Code templates can be found at
 \url{https://github.com/mckunkel/G12_Corrections/tree/master/Efficiency}.
The file '\emph{EfficiencyCodes.tar}' is a packed tar file that has code templates for the user to model their study against. Its advisable to read the codes and the following sections before using the codes.
To untar the file;
\begin{lstlisting}
tar -xf EfficiencyCodes.tar
\end{lstlisting}
this will produce a folder \newline
`\emph{EfficiencyCodes}` \newline
which contains the folders
\begin{itemize}
	\item BOSSkimCodes
	\item Data
	\item MC
	\item MakeEffs
\end{itemize}
\subsection{Data Processing Codes}
The folder `\emph{BOSSkimCodes}` contains the folders
\begin{itemize}
	\item PIM\_EFF
	\item PIP\_EFF
	\item PROT\_EFF
\end{itemize}
and the source file
\begin{itemize}
	\item buildCentos65.cshrc
\end{itemize}
with each containing the skim codes to be used on the output of \abbr{a1c}. It is important that these executables be used for both data and Monte-Carlo. Most of the skimming procedures start around lines 331 of the Ppp\_cE.cc files. These files are responsible for creating a ROOT file with all the needed features for this type of study.
To build these scripts, please update the 
\begin{itemize}
	\item buildCentos65.cshrc
\end{itemize}
file to the CENTOS version on JLab cluster and source the script
\begin{lstlisting}
source buildCentos65.cshrc
\end{lstlisting}
then in each folder  
\begin{lstlisting}
scons Ppp_cE.cc
\end{lstlisting}
If there are any problems building this software, please contact the \abbr{CLAS} librarian and inquire about the build system for the \abbr{CLAS6} software.
\subsection{Data Processing Pipeline}
In the folders 
\begin{itemize}
	\item Data
	\item MC/SimulationCodes
\end{itemize}
are submit scripts written in PERL that need to be modified by the user to ensure the proper pipeline. 
There are helper scripts
\begin{itemize}
	\item Data/EXECUTABLES/get\_codes.bash
	\item MC/SimulationCodes/get\_codes.bash
\end{itemize}
that help putting the needed executables in their proper place.
However, pipelining the procedure is standard CLAS procedure, so this will not be covered in detail here.
\subsection{Making Track Efficiency Plots}
In the folders
\begin{itemize}
	\item EfficiencyCodes/MakeEffs/X
\end{itemize} 
,where X is the particle name, are codes to help the user make the maps for both MC and data.
The codes starting with name
\begin{itemize}
	\item Make\_*.C
\end{itemize}
are templates used to create various mappings that were tested.
The ones used for analysis were derived from 
\begin{itemize}
	\item Make\_X\_Efficiency.C
	\item Make\_X\_Efficiency\_MC.C
\end{itemize}
where X is the particle name. The other scripts were in beta testing, use responsibly.

The codes that have name similar to 
\begin{itemize}
	\item Compare\_*\_new.C
\end{itemize}
create the mapping and ROOT file for lookup.
Once all of this is done, create a lookup script similar to below and happy analyzing.
\begin{lstlisting}
TString P_value = Prot_Hist_num(Vz,P_Ptot_fit);

//cout<<P_value<<"  "<<Ep_value<<"  "<<Em_value<<endl;


if (P_value =="") {
event_prot_eff = 0.0;
//cout<<Vz<<endl;
}
else{
TH2D *hEff_P= (TH2D*)P_Data.Get(P_value);
for (int x = 1; x<=hEff_P->GetNbinsX(); x++) {
for (int y = 1; y<=hEff_P->GetNbinsY(); y++) {
if (abs(P_Theta_fit*sin(P_Phi_fit*TMath::Pi()/180.) - hEff_P->GetXaxis()->GetBinCenter(x)) <= 4. && abs(P_Theta_fit*cos(P_Phi_fit*TMath::Pi()/180.) - hEff_P->GetYaxis()->GetBinCenter(y)) <= 4.) {
//cout<<hEff_plot->GetBinContent(x,y)<<endl;
event_prot_eff = hEff_P->GetBinContent(x,y);
}
//cout<<hPimEff_I_II->GetBinContent(x,y)<<"  "<<hEff_plot->GetBinContent(x,y)<<endl;
}
}
}
\end{lstlisting}
       
       
       
\begin{lstlisting}
TString Prot_Hist_num(Double_t z, Double_t p){


//cout<<"I am active"<<endl;
if (z <= -105.  ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_I_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_I_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_I_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_I_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_I_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_I_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_I_VII";
}

else if ( p > 3. ) {
return "hProtEff_I_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z <= -100. && z > -105. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_II_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_II_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_II_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_II_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_II_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_II_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_II_VII";
}

else if ( p > 3. ) {
return "hProtEff_II_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z <= -95. && z > -100. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_III_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_III_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_III_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_III_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_III_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_III_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_III_VII";
}

else if ( p > 3. ) {
return "hProtEff_III_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z <= -90. && z > -95. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_IV_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_IV_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_IV_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_IV_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_IV_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_IV_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_IV_VII";
}

else if ( p > 3. ) {
return "hProtEff_IV_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z <= -85. && z > -90. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_V_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_V_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_V_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_V_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_V_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_V_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_V_VII";
}

else if ( p > 3. ) {
return "hProtEff_V_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z <= -80. && z > -85. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_VI_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_VI_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_VI_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_VI_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_VI_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_VI_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_VI_VII";
}

else if ( p > 3. ) {
return "hProtEff_VI_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z <= -75. && z > -80. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_VII_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_VII_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_VII_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_VII_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_VII_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_VII_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_VII_VII";
}

else if ( p > 3. ) {
return "hProtEff_VII_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else if (z > -75. ){

if (p <= 0.5 && p > 0. ) {
return "hProtEff_VIII_I";
}

else if (p <= 0.75 && p > 0.5 ) {
return "hProtEff_VIII_II";
}

else if (p <= 1. && p > 0.75 ) {
return "hProtEff_VIII_III";
}

else if (p <= 1.5 && p > 1. ) {
return "hProtEff_VIII_IV";
}

else if (p <= 2. && p > 1.5 ) {
return "hProtEff_VIII_V";
}

else if (p <= 2.5 && p > 2. ) {
return "hProtEff_VIII_VI";
}

else if (p <= 3. && p > 2.5 ) {
return "hProtEff_VIII_VII";
}

else if ( p > 3. ) {
return "hProtEff_VIII_VIII";
}

else {
cout<<"NOT IN BOUNDS WITH MOMENTUM"<<endl; return "";
}

}

else {
//cout<<"NOT IN BOUNDS WITH z VERTEX"<<endl;
return "";
}

//cout<<"I am at the end "<<z<<"  "<<p<<endl;

}

\end{lstlisting}        
Compare
\bibliographystyle{unsrt}
\bibliography{PI0}
\end{document}